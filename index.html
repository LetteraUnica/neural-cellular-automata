<!doctype html>
<meta charset="utf-8">
<script src="website/template-1.1.1/dist/template.js"></script>

<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BMS9095G9B"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-BMS9095G9B');
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js" integrity="sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          // customised options
          // • auto-render specific keys, e.g.:
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          // • rendering keys, e.g.:
          throwOnError : false
        });
    });
</script>

<script type="text/front-matter">
  title: "Article Title"
  description: "Description of the post"
  authors:
  - Lorenzo Cavuoti: https://github.com/LetteraUnica
  - Francesco Sacco: http://github.com/Francesco215
  affiliations:
  - University of Triest: http://units.it
  - University of Pisa: http://unipi.it
</script>

<dt-article>
  <h1>Stopping Aging in Neural Cellular Automata</h1>
  <h2>Cause being old sucks</h2>
  <dt-byline></dt-byline>
  <p>Most living organisms age and eventually die because of it, but a few don’t, and some of
    them are incredibly hard to kill, even if you cut their head off, it just regrows.
    Neural Cellular Automata are very good representation of living organisms, scientists managed
    to create cellural automatas that are able to represent any image, some of them are mortal,
    some of them are immortal, and some of them are able to regenerate incredibly effectively
    <dt-cite key="mordvintsev2020growing"></dt-cite>
  </p>
  <p>
    In this paper we are going to discuss the condition necessary to make a mortal neural
    cellular automata, immortal 
  </p>
  <h2><a class="marker" href="#section-1" id="section-1">1</a> Switching the Rule</h2>
  <p>
    In this part of the paper we wanted to know if it is possible to take a cellular automata
    in the growing mode and after a arbitrary number $n$ of steps 
    <dt-fn> By arbitrary we mean any number of steps before the cellular automata decays</dt-fn>
    we switch the update rule in order to make it regenerating. We can write it mathematically like this 
    $$
      \begin{cases}
        x_{new}=f_1(x_{old})\quad \textrm{ if }\quad n_{iter} \le n\\
        x_{new}=f_2(x_{old})\quad \textrm{ if }\quad n_{iter} > n
      \end{cases}
    $$
  </p>
  <p>
    Where $f_1$ is a growing rule and $f_2$ is a rule that we trained to make the organism regenerating
    <dt-fn>if we change $n$ we don't need to change $f_2$</dt-fn>
  </p>
  <div class="l-middle side">
    <a class="marker" href="#image-1" id="image-1">
      <img src="pytorch_ca/switch_visuals/switch60.gif" style='height: 100%; width: 100%; object-fit: contain'>
    </a>
    <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
      Video 1: Here the rule switches at the 60th step
    </figcaption>
  </div>

  <p>
    If we want to make a parallel with a biological system this is equivalent to asking:
    Is it possible to make an organism immortal if we have the ability to change its DNA in every single cell
    at once? 
  </p>
  <p>
    The answer is yes. Video <a href="#image-1">1</a> shows you what happens.
  </p>
  <p>
    In order to achieve this we took a growing CA and evolved it for a number
    of steps between 0 and 60, then we took the final state and passed it to a
    new cellular automata that we are going to call “Switch”.
  </p>
  <p>
    So we trained Switch to be able to become a Regenerating cellular automata starting from an input Growing
    <dt-fn>
      The training seemed to be highly dependent from the starting parameters,
      in particular if we started from a Regenerating CA the net seemed to converge faster,
      if we took another CA, often times it wasn't able to converge
    </dt-fn>
  </p>
  <p>
    Here are some things you cannot do with our procedure: 
    <ul>
      <li>You cannot just swap the Growing rule with another Regenerating rule</li>
      <li>You cannot use a Switch CA for a Growing CA which has not been trained for</li>
      <li>You cannot salvage a Growing rule that has decayed</li>
    </ul>
  </p>
  <h2><a class="marker" href="#section-2" id="section-2">2</a> Virus with fixed mask</h2>
  <h2><a class="marker" href="#section-3" id="section-3">3</a> Virus with evolving mask</h2>
  <p>
    Realistically speaking if we want to make a grown organism immortal
    we won't have the accuracy necessary to modify every single cell of an
    organism at once without missing even one. So the next question we asked
    ourselves was: Is it possible to make an organism immortal without
    changing all of its cells? 
  </p>
  <p>
    To be able to answer the question we first have to ask ourselves another
    question: how do we model a Cellular Automata can represent an organism
    with cells of different DNA? 
  </p>
  <h3><a class="marker" href="#section-3.1" id="section-3.1">3.1</a> The Model</h2>
  <p>
    For simplicity we are going to restrict ourself in the case where we are going to have 2 rules ($f_1$ and $f_2$). 
  </p>
  <p>
    Before, a cell state was represented by a state vector having the first 4 components representing
    the RGBA of the pixel and the remaining were hidden channels that helped the CA pass more
    information between its cells. If the $\alpha$ channel (transparency) is >0.1 it means
    that the cell is alive, otherwise it’s dead
  </p>
  <p>
    If we are going to have two different types of cells we are going to need two alpha channels.
    Since a cell cannot be of both kinds at the same time we choose that if $\alpha_1$ is $>0.1$, then
    $\alpha_2$ must be 0, and the cell update follows $f_1$ and vice versa.
  </p>
  <p>
    When both alphas are below $0.1$, then the cell evolves with the sum of both updates 
  </p>
  <h3><a class="marker" href="#section-3.2" id="section-3.2">3.2</a> Conclusion</h2>
  <p>
    * Waiting for the training results * 
  </p>
  <h2><a class="marker" href="#section-4" id="section-4">3</a> Adding a perturbation</h2>
  <p>
    We wanted to know if we can add a small perturbation to the output of a growing cellular automata
    in order to make it a persistent one, this is very interesting from a biological perspective
    because we can answer the question: 
  </p>
  <p>
    How much do we need to change the rule (or DNA) in order to have a non-aging organism? 
  </p>
  <h3><a class="marker" href="#section-4.1" id="section-4.1">4.1</a> The Model</h2>

  <p>
    We model the perturbation as a function of the cell state $x$, note that the perturbation can
    be any function of the cell state, however we chose to use another CA to model it. Finally
    we compute the next cell state as a sum of both the growing and the perturbation $\Delta f$:
    $$
      x_{new}=f_{grow}(x_{old})+ \Delta f(x_{old})
    $$
  </p>
  <div class="l-middle side">
    <a class="marker" href="#image-" id="image-">
      <img src="pytorch_ca/Presentation_videos/perturbation_l_10.gif" style='height: 100%; width: 100%; object-fit: contain'>
    </a>
    <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
      Video 2: Perturbation of the weights with $\lambda=10$
    </figcaption>
  </div>
  <p>
    To prevent that the perturbation will overwrite the growing part we added an additional term
    in the loss, which penalizes the $\mathbf L_2$ norm of the perturbation $||\Delta f||_2$,
    the goal is to keep the perturbation as low as possible and prevent it overwriting the growing
    part of the rule
  </p>
  <p>
    It turns out that a very little perturbation (about 20% w.r.t. the total norm) can
    make the growing CA a persistent or even a regenerating one, with minimal effect
    on the quality of the image as can be seen on the video below. 
  </p>
  <h3><a class="marker" href="#section-4.2" id="section-4.2">4.2</a> Conclusion</h2>
  <p>
    The rule that the growing learned is very close to a persistent/regenerating one, could this
    mean that we need a very little change in the DNA to make a real organism immortal? 
  </p>


</dt-article>

<dt-appendix>
</dt-appendix>

<script type="text/bibliography">
  @article{mordvintsev2020growing,
    author = {Mordvintsev, Alexander and Randazzo, Ettore and Niklasson, Eyvind and Levin, Michael},
    title = {Growing Neural Cellular Automata},
    journal = {Distill},
    year = {2020},
    url = {https://distill.pub/2020/growing-ca},
  }

  @article{randazzo2021adversarial,
    author = {Randazzo, Ettore and Mordvintsev, Alexander and Niklasson, Eyvind and Levin, Michael},
    title = {Adversarial Reprogramming of Neural Cellular Automata},
    journal = {Distill},
    year = {2021},
    note = {https://distill.pub/selforg/2021/adversarial},
    doi = {10.23915/distill.00027.004}
  }
</script>